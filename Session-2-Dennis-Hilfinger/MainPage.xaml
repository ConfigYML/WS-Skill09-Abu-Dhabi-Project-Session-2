<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Session_2_Dennis_Hilfinger.MainPage"
             Title="Manage Flights">
    <ContentPage.Resources>
        <Style x:Key="HightlightedLabelStyle" TargetType="Label">
            <Setter Property="TextColor" Value="#000000"/>
            <Style.Triggers>
                <DataTrigger
                    TargetType="Label"
                    Binding="{Binding Confirmed}"
                    Value="False">
                    <Setter Property="TextColor" Value="#FFFFFF"/>
                </DataTrigger>

            </Style.Triggers>
        </Style>
    </ContentPage.Resources>
    <VerticalStackLayout Spacing="20">

        <Grid
            RowDefinitions="*, *"
            ColumnDefinitions="*, *, *"
            RowSpacing="20"
            ColumnSpacing="10">
            <HorizontalStackLayout 
                Grid.Column="0" 
                Grid.Row="0"
                Spacing="10"
                HorizontalOptions="Center">
                <Label
                    Text="From"
                    VerticalOptions="Center" />
                <Picker
                    x:Name="DeparturePicker"
                    VerticalOptions="Center"
                    WidthRequest="150"/>
            </HorizontalStackLayout>

            <HorizontalStackLayout 
                Grid.Column="1" 
                Grid.Row="0"
                Spacing="10"
                HorizontalOptions="Center">
                <Label
                    Text="To"
                    VerticalOptions="Center" />
                <Picker
                    x:Name="DestinationPicker"
                    VerticalOptions="Center"
                    WidthRequest="150"/>
            </HorizontalStackLayout>

            <HorizontalStackLayout 
                Grid.Column="2" 
                Grid.Row="0"
                Spacing="10"
                HorizontalOptions="Center">
                <Label
                    Text="Sort by"
                    VerticalOptions="Center" />
                <Picker
                    x:Name="SortingPicker"
                    VerticalOptions="Center"
                    WidthRequest="150"/>
            </HorizontalStackLayout>

            <HorizontalStackLayout 
                Grid.Column="0" 
                Grid.Row="1"
                Spacing="10"
                HorizontalOptions="Center">
                <Label
                    Text="Outbound"
                    VerticalOptions="Center" />
                <Entry
                    x:Name="OutboundDateInput"
                    VerticalOptions="Center"
                    WidthRequest="150"
                    Placeholder="dd/mm/yyyy"/>
            </HorizontalStackLayout>


            <HorizontalStackLayout 
                Grid.Column="1" 
                Grid.Row="1"
                Spacing="10"
                HorizontalOptions="Center">
                <Label
                    Text="Flight number"
                    VerticalOptions="Center" />
                <Entry
                    x:Name="FlightNumberInput"
                    VerticalOptions="Center"
                    WidthRequest="150"/>
            </HorizontalStackLayout>

            <Button 
                Text="Apply"
                Clicked="LoadData"
                VerticalOptions="Center"
                HorizontalOptions="Center"
                HeightRequest="50"
                WidthRequest="150"
                Grid.Row="1"
                Grid.Column="2"/>
        </Grid>

        <CollectionView x:Name="FlightGrid"
                VerticalOptions="Center"
                HorizontalOptions="Center"
                HeightRequest="300"
                WidthRequest="1000"
                SelectionMode="Single"
                SelectionChanged="FlightSelected">
            <CollectionView.Header>
                <Grid ColumnDefinitions="*, *, *, *, 2*, *, 2*, 2*, 2*">
                    <Label Text="Date" Grid.Column="0" FontAttributes="Bold"/>
                    <Label Text="Time" Grid.Column="1" FontAttributes="Bold"/>
                    <Label Text="From" Grid.Column="2" FontAttributes="Bold"/>
                    <Label Text="To" Grid.Column="3" FontAttributes="Bold"/>
                    <Label Text="Flight number" Grid.Column="4" FontAttributes="Bold"/>
                    <Label Text="Aircraft" Grid.Column="5" FontAttributes="Bold"/>
                    <Label Text="Economy price" Grid.Column="6" FontAttributes="Bold"/>
                    <Label Text="Business price" Grid.Column="7" FontAttributes="Bold"/>
                    <Label Text="First class price" Grid.Column="8" FontAttributes="Bold"/>
                </Grid>
            </CollectionView.Header>
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid ColumnDefinitions="*, *, *, *, 2*, *, 2*, 2*, 2*">

                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Style.Triggers>

                                    <DataTrigger 
                                        TargetType="Grid"
                                        Binding="{Binding Confirmed}"
                                        Value="False">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PrimaryBlue}"/>
                                    </DataTrigger>

                                </Style.Triggers>
                            </Style>
                        </Grid.Style>

                        <Label Text="{Binding FlightDate}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="0"/>
                        <Label Text="{Binding FlightTime}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="1"/>
                        <Label Text="{Binding DepartureAirport}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="2"/>
                        <Label Text="{Binding DestinationAirport}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="3"/>
                        <Label Text="{Binding FlightNumber}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="4"/>
                        <Label Text="{Binding Aircraft}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="5"/>
                        <Label Text="{Binding BasePrice}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="6"/>
                        <Label Text="{Binding BusinessPrice}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="7"/>
                        <Label Text="{Binding FirstClassPrice}" Style="{StaticResource HightlightedLabelStyle}" Grid.Column="8"/>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <HorizontalStackLayout Spacing="50" HorizontalOptions="Center">
            <Button Text="Cancel Flight"
                    x:Name="CancelBtn"
                    Clicked="CancelFlight"
                    HeightRequest="50"
                    WidthRequest="150"
                    IsEnabled="False"/>
            <Button Text="Edit Flight"
                    x:Name="EditBtn"
                    Clicked="EditFlight"
                    HeightRequest="50"
                    WidthRequest="150"
                    IsEnabled="False"/>
            <Button Text="Import Changes"
                    Clicked="ImportChanges"
                    HeightRequest="50"
                    WidthRequest="250"
                    Margin="100, 0, 0, 0"/>
        </HorizontalStackLayout>

    </VerticalStackLayout>

</ContentPage>
